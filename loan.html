<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Loan Details</title>
<style>
:root{
  --bg:#f3f6f9;--card:#fff;--accent:#1f6feb;--muted:#64748b;
  --success:#047857;--danger:#b91c1c;--warn:#92400e;font-family:Inter,system-ui,sans-serif;
}
body{margin:0;background:var(--bg);color:#0f172a}
.topbar{background:#0f172a;color:#fff;padding:14px 20px;display:flex;justify-content:space-between;align-items:center}
.topbar h1{margin:0;font-size:16px}
.container{max-width:1100px;margin:24px auto;background:var(--card);border-radius:10px;box-shadow:0 2px 8px rgba(0,0,0,.05);padding:24px}
.tabs{display:flex;gap:10px;border-bottom:1px solid #e5e7eb;margin-bottom:16px;flex-wrap:wrap}
.tab{background:none;border:0;padding:10px 12px;font-weight:600;cursor:pointer}
.tab.active{color:var(--accent);border-bottom:3px solid var(--accent)}
.panel{display:none}
.panel.active{display:block}
label{font-weight:600;font-size:14px;display:block;margin-bottom:4px}
.input-like{background:#f9fafb;border:1px solid #e5e7eb;border-radius:8px;padding:10px;font-size:14px}
.grid2{display:grid;grid-template-columns:1fr 1fr;gap:18px}
.badge{border-radius:6px;padding:5px 10px;font-size:12px;font-weight:700;display:inline-block}
.badge.approved{background:#ecfdf5;color:var(--success)}
.badge.rejected{background:#fef2f2;color:var(--danger)}
.badge.onhold{background:#fefce8;color:var(--warn)}
.btn{background:var(--accent);color:#fff;border:0;padding:8px 14px;border-radius:6px;cursor:pointer}
@media(max-width:700px){.grid2{grid-template-columns:1fr}}
</style>
</head>
<body>
<div class="topbar">
  <div>
    <button onclick="location.href='index.html'" style="background:none;border:0;color:#cbd5e1;font-weight:700;cursor:pointer">← Back</button>
    <h1 style="display:inline;margin-left:8px">Loan Details</h1>
  </div>
  <div id="statusBadge"></div>
</div>

<div class="container">
  <h2 id="loanId" style="margin-top:0"></h2>
  <div style="color:var(--muted);font-size:14px;margin-bottom:20px" id="borrowerLine"></div>

  <!-- Tabs -->
  <div class="tabs">
    <button class="tab active" data-tab="analysis">Analysis Summary</button>
    <button class="tab" data-tab="bank">Bank Statements</button>
    <button class="tab" data-tab="business">Business Narrative</button>
    <button class="tab" data-tab="f1003">1003</button>
    <button class="tab" data-tab="credit">Credit Report</button>
    <button class="tab" data-tab="broker">Broker Form</button>
  </div>

  <!-- Panels -->
  <div class="panel active" id="analysis">
    <h3>Analysis Summary</h3>
    <p>Loan approved based on hard-coded mock analysis.</p>
  </div>

  <div class="panel" id="bank">
    <h3>Bank Statements</h3>
    <ul id="bankList"></ul>
  </div>

  <div class="panel" id="business">
    <h3>Business Narrative Form</h3>
    <div class="grid2">
      <div>
        <label>Borrower Name</label><div class="input-like" id="bBorrower"></div>
        <label>Entity Name</label><div class="input-like" id="bEntity"></div>
        <label>Company Start Date</label><div class="input-like" id="bStart"></div>
      </div>
      <div>
        <label>% Ownership</label><div class="input-like" id="bOwner"></div>
        <label>Loan Number</label><div class="input-like" id="bLoan"></div>
        <label>Status</label><div class="input-like" id="bStatus"></div>
      </div>
    </div>
    <label style="margin-top:14px;display:block">Describe how your business generates revenue</label>
    <div class="input-like" id="bRevenue" style="min-height:70px;white-space:pre-wrap"></div>
  </div>

  <div class="panel" id="f1003">
    <h3>Form 1003 Summary</h3>
    <div class="grid2">
      <div><label>Loan Purpose</label><div class="input-like" id="fPurpose"></div></div>
      <div><label>Monthly Income</label><div class="input-like" id="fIncome"></div></div>
    </div>
  </div>

  <div class="panel" id="credit">
    <h3>Credit Report</h3>
    <p id="creditInfo"></p>
  </div>

  <div class="panel" id="broker">
    <h3>Broker Form</h3>
    <label>Broker Notes</label><div class="input-like" id="brokerNotes" style="min-height:70px;white-space:pre-wrap"></div>
  </div>
</div>

<script>
/* Load from localStorage */
let loan;
try{loan=JSON.parse(localStorage.getItem("selectedLoan"))||{};}catch{loan={};}
if(!loan.id){loan={id:"LN-10027",borrower:"Rahul Sharma",amount:1250000,apr:11.75,status:"Approved",
  business:"Sharma Textiles",ownership:"80%",startDate:"2015-04-12",
  revenueDesc:"Retail textile sales in Chennai.",notes:"Demo loan"};}

function formatINR(n){return new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR",maximumFractionDigits:0}).format(n);}
document.getElementById("loanId").textContent=`#${loan.id} – ${formatINR(loan.amount)} @ ${loan.apr}%`;
document.getElementById("borrowerLine").textContent=loan.borrower+" · "+(loan.business||"—");
document.getElementById("statusBadge").innerHTML=`<span class="badge ${loan.status?.toLowerCase().replace(' ','')||'onhold'}">${loan.status||'On Hold'}</span>`;

/* fill fields */
bBorrower.textContent=loan.borrower||"—";
bEntity.textContent=loan.business||"—";
bStart.textContent=loan.startDate||"—";
bOwner.textContent=loan.ownership||"—";
bLoan.textContent=loan.id||"—";
bStatus.textContent=loan.status||"—";
bRevenue.textContent=loan.revenueDesc||loan.notes||"—";
fPurpose.textContent="Purchase";
fIncome.textContent=formatINR(45000);
creditInfo.textContent="Credit Score 710 – Stable profile.";
brokerNotes.textContent="Client requested expedited processing.";

/* simple tab logic */
const tabs=document.querySelectorAll(".tab"),panels=document.querySelectorAll(".panel");
tabs.forEach(t=>t.addEventListener("click",()=>{
  tabs.forEach(b=>b.classList.remove("active"));
  t.classList.add("active");
  panels.forEach(p=>p.classList.remove("active"));
  document.getElementById(t.dataset.tab).classList.add("active");
}));

/* bank list demo */
document.getElementById("bankList").innerHTML="<li>StateBank_2024-01.pdf</li><li>HDFC_Q1.pdf</li>";
</script>
</body>
</html>
